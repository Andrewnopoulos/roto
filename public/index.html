<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rota - Multiplayer Game</title>
    <link rel="stylesheet" href="/styles.css">
</head>
<body>
    <div id="app">
        <!-- Connection Status -->
        <div id="connection-status" class="connection-status">
            <span id="connection-text">Connecting...</span>
        </div>

        <!-- Login Dialog (Top-left overlay) -->
        <div id="loginDialog" class="login-dialog hidden">
            <div class="login-dialog-content">
                <div class="login-dialog-header">
                    <h3>Account</h3>
                    <button id="closeLoginDialog" class="close-btn">&times;</button>
                </div>
                
                <div class="auth-tabs">
                    <button id="loginTab" class="auth-tab active">Login</button>
                    <button id="registerTab" class="auth-tab">Register</button>
                </div>
                
                <form id="loginForm" class="auth-form">
                    <input type="email" id="loginEmail" placeholder="Email" required>
                    <input type="password" id="loginPassword" placeholder="Password" required>
                    <button type="submit" id="loginBtn">Login</button>
                </form>
                
                <form id="registerForm" class="auth-form hidden">
                    <input type="text" id="registerUsername" placeholder="Username" required>
                    <input type="email" id="registerEmail" placeholder="Email" required>
                    <input type="password" id="registerPassword" placeholder="Password (min 6 chars)" required>
                    <button type="submit" id="registerBtn">Register</button>
                </form>
                
                <div id="authError" class="auth-error hidden"></div>
            </div>
        </div>

        <!-- User Status (Top-left) -->
        <div id="userStatus" class="user-status">
            <div id="guestStatus" class="guest-status">
                <span class="guest-icon">üë§</span>
                <span>Guest</span>
                <button id="showLoginDialog" class="login-prompt-btn">Login / Register</button>
            </div>
            <div id="userInfo" class="user-info hidden">
                <span class="user-icon">üéÆ</span>
                <span id="currentUsername">User</span>
                <button id="logoutBtn" class="logout-btn">Logout</button>
            </div>
        </div>

        <!-- Guest Play Warning Dialog -->
        <div id="guestWarningDialog" class="warning-dialog hidden">
            <div class="warning-dialog-content">
                <div class="warning-icon">‚ö†Ô∏è</div>
                <h3>Playing as Guest</h3>
                <p>You're about to play as a guest. Your game statistics and progress won't be saved.</p>
                <p><strong>Create an account</strong> to track your rating, wins, and unlock competitive features!</p>
                <div class="warning-actions">
                    <button id="continueAsGuest" class="btn-secondary">Continue as Guest</button>
                    <button id="showLoginFromWarning" class="btn-primary">Login / Register</button>
                </div>
            </div>
        </div>

        <!-- Menu Screen -->
        <div id="menu" class="screen active">
            <div class="menu-container">
                <h1>Rota Game</h1>
                <p>A strategic multiplayer game</p>
                
                <!-- Collapsible Rules Section -->
                <details class="rules-section">
                    <summary class="rules-toggle">üìñ How to Play</summary>
                    <div class="rules-content">
                        <div class="rules-grid">
                            <div class="rule-item">
                                <strong>üéØ Goal:</strong>
                                <span>Be the first to get 3 pieces in a straight line</span>
                            </div>
                            <div class="rule-item">
                                <strong>üìç Setup:</strong>
                                <span>2 players, each with 3 pieces on a 9-cell circular board</span>
                            </div>
                            <div class="rule-item">
                                <strong>üéÆ Phase 1 - Place:</strong>
                                <span>Take turns placing your 3 pieces anywhere on empty cells</span>
                            </div>
                            <div class="rule-item">
                                <strong>üö∂ Phase 2 - Move:</strong>
                                <span>Move your pieces to adjacent empty cells to form a line</span>
                            </div>
                        </div>
                        <div class="rules-footer">
                            <a href="https://www.ancientgames.org/rota/" target="_blank" rel="noopener" class="rules-link">
                                üìö Full Rules & Strategy Guide ‚Üí
                            </a>
                        </div>
                    </div>
                </details>
                
                <div class="menu-form">
                    <button id="quickplayBtn" class="quickplay-btn">[‚ö°] Quick Play</button>
                    <div class="divider">
                        <span>or</span>
                    </div>
                    <input type="text" id="roomId" placeholder="Enter Room ID" maxlength="20">
                    <button id="joinRoom">Join Room</button>
                    <button id="createRoom">Create New Room</button>
                </div>
            </div>
        </div>

        <!-- Lobby Screen -->
        <div id="lobby" class="screen">
            <div class="lobby-container">
                <h2>Room: <span id="currentRoomId"></span></h2>
                <div class="player-info">
                    <p>Players: <span id="playerCount">0</span>/2</p>
                    <p id="waitingMessage">Waiting for another player...</p>
                </div>
                <div class="lobby-actions">
                    <button id="shareRoom">Share Room URL</button>
                    <button id="startGame" style="display: none;">Start Game</button>
                    <button id="leaveRoom">Leave Room</button>
                </div>
            </div>
        </div>

        <!-- Game Screen -->
        <div id="game" class="screen">
            <div class="game-container">
                <div class="game-header">
                    <!-- Prominent Turn Indicator -->
                    <div id="turnIndicator" class="turn-indicator">
                        <div id="turnMessage" class="turn-message">Your Turn!</div>
                        <div id="turnSubtext" class="turn-subtext">Click to place your piece</div>
                    </div>
                    
                    <!-- Subtle room info -->
                    <div class="room-info">Room: <span id="gameRoomId"></span></div>
                </div>
                
                <div class="board-container">
                    <svg viewBox="0 0 400 400" class="board" id="gameBoard">
                        <!-- Outer circle positions (0-7) -->
                        <circle cx="200" cy="50" r="20" class="cell" data-position="0"></circle>
                        <circle cx="328" cy="100" r="20" class="cell" data-position="1"></circle>
                        <circle cx="350" cy="200" r="20" class="cell" data-position="2"></circle>
                        <circle cx="328" cy="300" r="20" class="cell" data-position="3"></circle>
                        <circle cx="200" cy="350" r="20" class="cell" data-position="4"></circle>
                        <circle cx="72" cy="300" r="20" class="cell" data-position="5"></circle>
                        <circle cx="50" cy="200" r="20" class="cell" data-position="6"></circle>
                        <circle cx="72" cy="100" r="20" class="cell" data-position="7"></circle>
                        
                        <!-- Center position (8) -->
                        <circle cx="200" cy="200" r="20" class="cell center" data-position="8"></circle>
                        
                        <!-- Board lines -->
                        <g class="board-lines">
                            <!-- Outer circle -->
                            <circle cx="200" cy="200" r="150" fill="none" stroke="#333" stroke-width="2"></circle>
                            
                            <!-- Diameter lines -->
                            <line x1="200" y1="50" x2="200" y2="350" stroke="#333" stroke-width="2"></line>
                            <line x1="50" y1="200" x2="350" y2="200" stroke="#333" stroke-width="2"></line>
                            <line x1="72" y1="100" x2="328" y2="300" stroke="#333" stroke-width="2"></line>
                            <line x1="328" y1="100" x2="72" y2="300" stroke="#333" stroke-width="2"></line>
                        </g>
                    </svg>
                </div>
                
                <div class="game-actions">
                    <button id="restartGame" style="display: none;">Play Again</button>
                    <button id="endGame">End Game</button>
                </div>
            </div>
        </div>

        <!-- Notifications -->
        <div id="notifications" class="notifications"></div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script src="/script.js"></script>
</body>
</html>